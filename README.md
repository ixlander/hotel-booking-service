
# Hotel Booking Service

Это проект на Go для системы бронирования отелей с использованием чистой архитектуры и различных технологий, включая GORM, JWT-аутентификацию и Docker. Система позволяет пользователям регистрироваться, аутентифицироваться, бронировать номера и просматривать доступные отели.

## Технологии

- **Go (Golang)**: основной язык программирования
- **GORM**: ORM для работы с базой данных
- **JWT**: для аутентификации и авторизации
- **PostgreSQL**: база данных для хранения информации о пользователях, отелях, номерах и бронированиях
- **Docker**: для контейнеризации и упрощения развертывания
- **Chi**: HTTP роутер для обработки запросов
- **Validator**: библиотека для валидации данных

## Установка

Для запуска проекта локально необходимо выполнить несколько шагов.

### 1. Клонируйте репозиторий

```bash
git clone https://github.com/yourusername/hotel-booking-service.git
cd hotel-booking-service
```

### 2. Настройте окружение

Перед запуском убедитесь, что у вас настроены следующие переменные окружения:

- **DB_HOST**: хост базы данных (например, `localhost`)
- **DB_PORT**: порт базы данных (например, `5432`)
- **DB_USER**: пользователь базы данных (например, `postgres`)
- **DB_PASSWORD**: пароль пользователя базы данных
- **DB_NAME**: имя базы данных (например, `hotel_booking`)
- **JWT_SECRET**: секретный ключ для JWT (например, `your-secret-key`)

Вы можете создать файл `.env` в корне проекта, чтобы задать переменные окружения:

```bash
DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=password
DB_NAME=hotel_booking
JWT_SECRET=your-secret-key
```

### 3. Установите зависимости

Если у вас еще не установлен Go, скачайте и установите его с [официального сайта Go](https://golang.org/dl/).

После установки Go, установите зависимости проекта:

```bash
go mod tidy
```

### 4. Запустите проект с помощью Docker

Для удобства работы с проектом мы используем Docker. Сначала соберите и запустите контейнеры:

```bash
docker-compose up --build
```

Это создаст контейнер для базы данных PostgreSQL и запустит ваше приложение в контейнере.

### 5. Запуск без Docker

Если вы хотите запустить проект без использования Docker, выполните следующие шаги:

1. Убедитесь, что у вас запущена PostgreSQL база данных.
2. Выполните миграции базы данных:

```bash
go run cmd/migrate/main.go
```

3. Запустите проект:

```bash
go run cmd/main.go
```

### 6. Пример использования API

**Регистрация пользователя**:

```bash
POST /register
Content-Type: application/json
{
  "email": "user@example.com",
  "password": "yourpassword"
}
```

**Вход в систему (аутентификация)**:

```bash
POST /login
Content-Type: application/json
{
  "email": "user@example.com",
  "password": "yourpassword"
}
```

**Создание бронирования**:

```bash
POST /bookings
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json
{
  "room_id": 1,
  "from_date": "2023-05-01",
  "to_date": "2023-05-05"
}
```

**Просмотр всех отелей**:

```bash
GET /hotels
```

**Просмотр доступных номеров в отеле**:

```bash
GET /hotels/{hotel_id}/available?from_date=2023-05-01&to_date=2023-05-05
```

**Просмотр всех бронирований пользователя**:

```bash
GET /bookings
Authorization: Bearer <JWT_TOKEN>
```

**Отмена бронирования**:

```bash
DELETE /bookings/{id}
Authorization: Bearer <JWT_TOKEN>
```

## Структура проекта

- **cmd/** — Основной запуск проекта.
- **internal/** — Внутренняя логика приложения:
  - **app/** — Настройки приложения.
  - **data/** — Структуры данных (например, User, Hotel, Room).
  - **repositories/** — Репозитории для работы с базой данных.
  - **services/** — Логика взаимодействия с бизнес-слоями.
  - **usecases/** — Приложение бизнес-логики.
  - **deliveries/** — HTTP контроллеры и мидлвары.
  - **pkg/** — Утилиты и вспомогательные функции (например, обработка HTTP запросов).
- **docker-compose.yml** — Конфигурация для запуска приложения и базы данных с помощью Docker.
- **go.mod** — Модуль для управления зависимостями.
- **go.sum** — Контроль версий зависимостей.

## Тестирование

Для написания тестов мы использовали библиотеку `testify` для юнит-тестирования. Тесты можно запускать с помощью команды:

```bash
go test ./...
```
